---
// Navbar component
const baseUrl = import.meta.env.BASE_URL;
const homeUrl = baseUrl === '/' ? '/' : baseUrl.replace(/\/$/, '') || '/';
---

<nav>
	<div class="navbar-container">
		<a href={homeUrl} class="logo">Portafolio</a>
		<button class="menu-toggle" aria-label="Toggle menu" id="menu-toggle">
			<span></span>
			<span></span>
			<span></span>
		</button>
		<ul class="nav-links" id="nav-links">
			<li><a href={homeUrl} data-i18n="nav.home">Inicio</a></li>
			<li><a href="#about" data-i18n="nav.about">Sobre mÃ­</a></li>
			<li><a href="#experience" data-i18n="nav.experience">Experiencia</a></li>
			<li><a href={`${baseUrl}projects`} data-i18n="nav.projects">Proyectos</a></li>
			<li><a href="#contact" data-i18n="nav.contact">Contacto</a></li>
		</ul>
		<div class="language-selector">
			<button class="lang-toggle" id="lang-toggle" aria-label="Seleccionar idioma">
				<span class="lang-flag">ðŸ‡ªðŸ‡¸</span>
				<span class="lang-code">ES</span>
				<svg class="lang-arrow" viewBox="0 0 24 24" fill="currentColor">
					<path d="M7 10l5 5 5-5z"/>
				</svg>
			</button>
			<div class="lang-dropdown" id="lang-dropdown">
				<button class="lang-option" data-lang="es">
					<span class="lang-flag">ðŸ‡ªðŸ‡¸</span>
					<span>EspaÃ±ol</span>
				</button>
				<button class="lang-option" data-lang="en">
					<span class="lang-flag">ðŸ‡ºðŸ‡¸</span>
					<span>English</span>
				</button>
				<button class="lang-option" data-lang="pt">
					<span class="lang-flag">ðŸ‡µðŸ‡¹</span>
					<span>PortuguÃªs</span>
				</button>
				<button class="lang-option" data-lang="de">
					<span class="lang-flag">ðŸ‡©ðŸ‡ª</span>
					<span>Deutsch</span>
				</button>
				<button class="lang-option" data-lang="fr">
					<span class="lang-flag">ðŸ‡«ðŸ‡·</span>
					<span>FranÃ§ais</span>
				</button>
				<button class="lang-option" data-lang="it">
					<span class="lang-flag">ðŸ‡®ðŸ‡¹</span>
					<span>Italiano</span>
				</button>
			</div>
		</div>
	</div>
</nav>

<script>
	const menuToggle = document.getElementById('menu-toggle');
	const navLinks = document.getElementById('nav-links');
	
	menuToggle?.addEventListener('click', () => {
		navLinks?.classList.toggle('active');
		menuToggle?.classList.toggle('active');
	});
	
	// Cerrar menÃº al hacer clic en un enlace
	navLinks?.querySelectorAll('a').forEach(link => {
		link.addEventListener('click', () => {
			navLinks?.classList.remove('active');
			menuToggle?.classList.remove('active');
		});
	});

	// Selector de idiomas
	const langToggle = document.getElementById('lang-toggle');
	const langDropdown = document.getElementById('lang-dropdown');
	const langOptions = document.querySelectorAll('.lang-option');

	if (langToggle && langDropdown) {
		langToggle.addEventListener('click', (e) => {
			e.stopPropagation();
			e.preventDefault();
			langDropdown.classList.toggle('active');
		});

		// Cerrar dropdown al hacer clic fuera
		document.addEventListener('click', (e) => {
			const target = e.target as Node;
			if (langToggle && langDropdown && 
				!langToggle.contains(target) && 
				!langDropdown.contains(target)) {
				langDropdown.classList.remove('active');
			}
		});

		langOptions.forEach(option => {
			option.addEventListener('click', (e) => {
				e.stopPropagation();
				const lang = option.getAttribute('data-lang');
				if (lang) {
					if (window.i18n) {
						window.i18n.changeLanguage(lang);
					} else {
						// Si i18n no estÃ¡ disponible, guardar el idioma y recargar
						localStorage.setItem('language', lang);
						location.reload();
					}
					langDropdown.classList.remove('active');
				}
			});
		});
	}
</script>

<style>
	nav {
		position: fixed;
		top: 0;
		left: 0;
		right: 0;
		background: rgba(10, 10, 10, 0.8);
		backdrop-filter: blur(20px) saturate(180%);
		-webkit-backdrop-filter: blur(20px) saturate(180%);
		z-index: 1000;
		border-bottom: 1px solid rgba(255, 255, 255, 0.1);
		box-shadow: 0 4px 30px rgba(0, 0, 0, 0.3);
	}

	.navbar-container {
		max-width: 1200px;
		margin: 0 auto;
		padding: 1.25rem 2rem;
		display: flex;
		justify-content: space-between;
		align-items: center;
	}

	.logo {
		font-size: 1.5rem;
		font-weight: 700;
		text-decoration: none;
		color: #ffffff;
		background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
		-webkit-background-clip: text;
		-webkit-text-fill-color: transparent;
		background-clip: text;
		transition: transform 0.3s;
	}

	.logo:hover {
		transform: scale(1.05);
	}

	.nav-links {
		display: flex;
		list-style: none;
		gap: 2.5rem;
		margin: 0;
		padding: 0;
		align-items: center;
	}

	.nav-links a {
		text-decoration: none;
		color: #e5e5e5;
		font-weight: 500;
		transition: color 0.3s;
		position: relative;
	}

	.nav-links a::after {
		content: '';
		position: absolute;
		bottom: -5px;
		left: 0;
		width: 0;
		height: 2px;
		background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
		transition: width 0.3s;
	}

	.nav-links a:hover {
		color: #ffffff;
	}

	.nav-links a:hover::after {
		width: 100%;
	}

	/* Light Theme */
	:global([data-theme="light"]) nav {
		background: rgba(255, 255, 255, 0.9);
		border-bottom: 1px solid rgba(0, 0, 0, 0.1);
		box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
	}

	:global([data-theme="light"]) .nav-links a {
		color: #333;
	}

	:global([data-theme="light"]) .nav-links a:hover {
		color: #000;
	}

	.menu-toggle {
		display: none;
		flex-direction: column;
		justify-content: space-around;
		width: 44px;
		height: 44px;
		background: transparent;
		border: none;
		cursor: pointer;
		padding: 0;
		z-index: 1001;
	}

	.menu-toggle span {
		width: 25px;
		height: 3px;
		background: #e5e5e5;
		border-radius: 3px;
		transition: all 0.3s ease;
		transform-origin: center;
	}

	:global([data-theme="light"]) .menu-toggle span {
		background: #333;
	}

	.menu-toggle.active span:nth-child(1) {
		transform: rotate(45deg) translate(8px, 8px);
	}

	.menu-toggle.active span:nth-child(2) {
		opacity: 0;
	}

	.menu-toggle.active span:nth-child(3) {
		transform: rotate(-45deg) translate(7px, -7px);
	}

	/* Mobile Styles */
	@media (max-width: 768px) {
		.navbar-container {
			padding: 1rem;
		}

		.menu-toggle {
			display: flex;
		}

		.nav-links {
			position: fixed;
			top: 70px;
			left: 0;
			right: 0;
			background: rgba(10, 10, 10, 0.98);
			backdrop-filter: blur(20px);
			-webkit-backdrop-filter: blur(20px);
			flex-direction: column;
			padding: 2rem 1rem;
			gap: 0;
			transform: translateX(-100%);
			transition: transform 0.3s ease;
			border-bottom: 1px solid rgba(255, 255, 255, 0.1);
			box-shadow: 0 4px 30px rgba(0, 0, 0, 0.5);
		}

		:global([data-theme="light"]) .nav-links {
			background: rgba(255, 255, 255, 0.98);
			border-bottom: 1px solid rgba(0, 0, 0, 0.1);
		}

		.nav-links.active {
			transform: translateX(0);
		}

		.nav-links li {
			width: 100%;
			border-bottom: 1px solid rgba(255, 255, 255, 0.1);
		}

		:global([data-theme="light"]) .nav-links li {
			border-bottom: 1px solid rgba(0, 0, 0, 0.1);
		}

		.nav-links li:last-child {
			border-bottom: none;
		}

		.nav-links a {
			display: block;
			padding: 1rem;
			font-size: 1.1rem;
			width: 100%;
			-webkit-tap-highlight-color: rgba(102, 126, 234, 0.2);
		}

		.nav-links a::after {
			display: none;
		}

		.nav-links a:hover,
		.nav-links a:active {
			background: rgba(102, 126, 234, 0.1);
			color: #ffffff;
		}

		:global([data-theme="light"]) .nav-links a:hover,
		:global([data-theme="light"]) .nav-links a:active {
			background: rgba(102, 126, 234, 0.1);
			color: #1a1a1a;
		}
	}

	/* Small mobile devices (iPhone SE, etc.) */
	@media (max-width: 375px) {
		.logo {
			font-size: 1.2rem;
		}

		.menu-toggle {
			width: 40px;
			height: 40px;
		}

		.nav-links {
			top: 65px;
		}
	}

	/* Language Selector */
	.language-selector {
		position: relative;
		margin-left: 1.5rem;
		z-index: 1001;
	}

	.lang-toggle {
		display: flex;
		align-items: center;
		gap: 0.5rem;
		padding: 0.5rem 1rem;
		background: rgba(255, 255, 255, 0.05);
		backdrop-filter: blur(10px);
		border: 1px solid rgba(255, 255, 255, 0.1);
		border-radius: 8px;
		color: #e5e5e5;
		cursor: pointer;
		transition: all 0.3s ease;
		font-size: 0.9rem;
		font-weight: 500;
	}

	.lang-toggle:hover {
		background: rgba(255, 255, 255, 0.1);
		border-color: rgba(102, 126, 234, 0.4);
	}

	.lang-flag {
		font-size: 1.2rem;
	}

	.lang-code {
		font-weight: 600;
	}

	.lang-arrow {
		width: 16px;
		height: 16px;
		transition: transform 0.3s ease;
	}

	.lang-toggle:hover .lang-arrow,
	.language-selector.active .lang-arrow {
		transform: rotate(180deg);
	}

	.lang-dropdown {
		position: absolute;
		top: calc(100% + 0.5rem);
		right: 0;
		background: rgba(10, 10, 10, 0.98);
		backdrop-filter: blur(20px);
		-webkit-backdrop-filter: blur(20px);
		border: 1px solid rgba(255, 255, 255, 0.1);
		border-radius: 12px;
		padding: 0.5rem;
		min-width: 150px;
		opacity: 0;
		visibility: hidden;
		transform: translateY(-10px);
		transition: all 0.3s ease;
		box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
		z-index: 1002;
		pointer-events: none;
	}

	.lang-dropdown.active {
		opacity: 1;
		visibility: visible;
		transform: translateY(0);
		pointer-events: all;
	}

	.lang-option {
		display: flex;
		align-items: center;
		gap: 0.75rem;
		width: 100%;
		padding: 0.75rem 1rem;
		background: transparent;
		border: none;
		border-radius: 8px;
		color: #e5e5e5;
		cursor: pointer;
		transition: all 0.3s ease;
		text-align: left;
		font-size: 0.95rem;
	}

	.lang-option:hover {
		background: rgba(102, 126, 234, 0.2);
		color: #ffffff;
	}

	.lang-option .lang-flag {
		font-size: 1.3rem;
	}

	:global([data-theme="light"]) .lang-toggle {
		background: rgba(0, 0, 0, 0.05);
		border: 1px solid rgba(0, 0, 0, 0.1);
		color: #333;
	}

	:global([data-theme="light"]) .lang-toggle:hover {
		background: rgba(0, 0, 0, 0.1);
		border-color: rgba(102, 126, 234, 0.3);
	}

	:global([data-theme="light"]) .lang-dropdown {
		background: rgba(255, 255, 255, 0.98);
		border: 1px solid rgba(0, 0, 0, 0.1);
		box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
	}

	:global([data-theme="light"]) .lang-option {
		color: #333;
	}

	:global([data-theme="light"]) .lang-option:hover {
		background: rgba(102, 126, 234, 0.15);
		color: #1a1a1a;
	}

	@media (max-width: 768px) {
		.language-selector {
			margin-left: 0;
			margin-top: 1rem;
		}

		.lang-dropdown {
			right: auto;
			left: 0;
		}
	}
</style>

